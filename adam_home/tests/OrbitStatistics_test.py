'''
    test_OrbitStatistics.py
    Unit test module

    from terminal: home/adam_home/tests
                   python -m unittest test_OrbitStatistics.py

                   OR

                   home/adam_home/tests
                   python test_OrbitStatistics.py
                   [when if __name__ block is available on line 64]

    METHOD LIST:    test_CartCovSymmetricFromCartCovSTK
                    test_ComputePeriodCovFromCartCov
                    test_TransformCovarianceScalar
'''

import unittest
import OrbitStatistics
import numpy as np
import sys
from os.path import expanduser
sys.path.append(expanduser("~") + "/adam_home/SEE_functions")


class test_OrbitStatistics(unittest.TestCase):

    def test_CartCovSymmetricFromCartCovSTK(self):

        # values_stk = ['5.60600000000000e+03',
        #               '4.07696263873150e+07', '-1.70809904449045e+08', '-9.66331679556395e+07',
        #               '1.57060063751855e+02', '1.13298048038556e+03', '3.89289745227734e+02\n',
        #               '1.05439097338782e+04', '-2.34492974147408e+03', '4.64345657396604e+03',
        #               '-3.14822202715566e+03', '6.06902201170811e+01', '4.29976728639937e+03',
        #               '-4.21413200898710e-02\n',
        #               '3.35105510396153e-02', '2.13465219181365e-02', '3.95118694344618e-07',
        #               '-3.28871551875770e-02', '8.58497071571136e-04', '1.61123365254981e-02',
        #               '8.10171502110303e-08\n',
        #               '1.77536195738882e-07', '4.21462146377177e-02', '1.97961560364326e-02',
        #               '-2.51847242620078e-02', '-2.47329891882243e-09', '-2.05478115461443e-07',
        #               '4.63398878632980e-07\n']

        values_stk = [5.60600000000000e+03, 4.07696263873150e+07, -1.70809904449045e+08,
                      -9.66331679556395e+07, 1.57060063751855e+02, 1.13298048038556e+03, 3.89289745227734e+02,
                      1.05439097338782e+04, -2.34492974147408e+03, 4.64345657396604e+03,
                      -3.14822202715566e+03, 6.06902201170811e+01, 4.29976728639937e+03, -4.21413200898710e-02,
                      3.35105510396153e-02, 2.13465219181365e-02, 3.95118694344618e-07,
                      -3.28871551875770e-02, 8.58497071571136e-04, 1.61123365254981e-02, 8.10171502110303e-08,
                      1.77536195738882e-07, 4.21462146377177e-02, 1.97961560364326e-02,
                      -2.51847242620078e-02, -2.47329891882243e-09, -2.05478115461443e-07, 4.63398878632980e-07]

        CartCov_6x6 = np.matrix([[1.05439097338782e+04, -2.34492974147408e+03, -3.14822202715566e+03,
                                 -4.21413200898710e-02, -3.28871551875770e-02, 4.21462146377177e-02],
                                [-2.34492974147408e+03, 4.64345657396604e+03, 6.06902201170811e+01,
                                 3.35105510396153e-02, 8.58497071571136e-04, 1.97961560364326e-02],
                                [-3.14822202715566e+03, 6.06902201170811e+01, 4.29976728639937e+03,
                                 2.13465219181365e-02, 1.61123365254981e-02, -2.51847242620078e-02],
                                [-4.21413200898710e-02, 3.35105510396153e-02, 2.13465219181365e-02,
                                 3.95118694344618e-07, 8.10171502110303e-08, -2.47329891882243e-09],
                                [-3.28871551875770e-02, 8.58497071571136e-04, 1.61123365254981e-02,
                                 8.10171502110303e-08, 1.77536195738882e-07, -2.05478115461443e-07],
                                [4.21462146377177e-02, 1.97961560364326e-02, -2.51847242620078e-02,
                                 -2.47329891882243e-09, -2.05478115461443e-07, 4.63398878632980e-07]])

        CC_6x6 = OrbitStatistics.CartCovSymmetricFromCartCovSTK(values_stk)

        self.assertEqual(CC_6x6.all(), CartCov_6x6.all())

        # if __name__ == '__main__':
        #    unittest.main()
